@page "/restaurants/create"
@rendermode InteractiveServer
@using Microsoft.EntityFrameworkCore
@using FoodDeliveryrestart.Domain
@inject IDbContextFactory<FoodDeliveryrestart.Data.FoodDeliveryrestartContext> DbFactory
@inject NavigationManager NavigationManager

<PageTitle>Create</PageTitle>

<div class="form-page">
    <div class="form-card">
        <h1>Create</h1>
        <h2>Restaurant</h2>

        <EditForm method="post" Model="Restaurant" OnValidSubmit="AddRestaurant" FormName="create" Enhance>
            <DataAnnotationsValidator />
            <ValidationSummary class="form-error" />

            <div class="form-section">
                <div class="form-row">
                    <div class="form-group">
                        <label for="name">Name</label>
                        <InputText id="name" @bind-Value="Restaurant.Name" />
                        <ValidationMessage For="() => Restaurant.Name" />
                    </div>

                    <div class="form-group">
                        <label for="cuisinetype">Cuisine</label>
                        <InputText id="cuisinetype" @bind-Value="Restaurant.CuisineType" />
                        <ValidationMessage For="() => Restaurant.CuisineType" />
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="operatinghours">Operating Hours</label>
                        <InputText id="operatinghours" @bind-Value="Restaurant.OperatingHours" />
                        <ValidationMessage For="() => Restaurant.OperatingHours" />
                    </div>

                    <div class="form-group">
                        <label for="locationwithinmall">Location within mall</label>
                        <InputText id="locationwithinmall" @bind-Value="Restaurant.LocationWithinMall" />
                        <ValidationMessage For="() => Restaurant.LocationWithinMall" />
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="mallid">Mall Id</label>
                        <InputNumber id="mallid" @bind-Value="Restaurant.MallId" />
                        <ValidationMessage For="() => Restaurant.MallId" />
                    </div>

                    <div class="form-group">
                        <label for="datecreated">Date Created</label>
                        <InputDate id="datecreated" @bind-Value="Restaurant.DateCreated" />
                        <ValidationMessage For="() => Restaurant.DateCreated" />
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="dateupdated">Date Updated</label>
                        <InputDate id="dateupdated" @bind-Value="Restaurant.DateUpdated" />
                        <ValidationMessage For="() => Restaurant.DateUpdated" />
                    </div>

                    <div class="form-group">
                        <label for="createdby">Created By</label>
                        <InputText id="createdby" @bind-Value="Restaurant.CreatedBy" />
                        <ValidationMessage For="() => Restaurant.CreatedBy" />
                    </div>
                </div>

                <div class="form-group">
                    <label for="updatedby">Updated By</label>
                    <InputText id="updatedby" @bind-Value="Restaurant.UpdatedBy" />
                    <ValidationMessage For="() => Restaurant.UpdatedBy" />
                </div>
            </div>

            <div class="form-actions">
                <button type="submit" class="btn-primary">Create</button>
                <button type="button" class="btn-secondary" @onclick='() => NavigationManager.NavigateTo("/admin/dashboard")'>Cancel</button>
            </div>
        </EditForm>

        <a class="back-link" href="/admin/dashboard">Back to Dashboard</a>
    </div>
</div>

@code {
    [SupplyParameterFromForm]
    private Restaurant Restaurant { get; set; } = new();

    // To protect from overposting attacks, see https://learn.microsoft.com/aspnet/core/blazor/forms/#mitigate-overposting-attacks.
    private async Task AddRestaurant()
    {
        using var context = DbFactory.CreateDbContext();
        context.Restaurant.Add(Restaurant);
        await context.SaveChangesAsync();
        NavigationManager.NavigateTo("/restaurants");
    }
}
